<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday Fireworks</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #08080c;
  overflow: hidden;
  font-family: Arial, sans-serif;
}
canvas { display: block; }

/* Buttons */
.controls {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 12px;
}

button {
  padding: 12px 22px;
  font-size: 15px;
  border: none;
  border-radius: 30px;
  cursor: pointer;
  background: linear-gradient(135deg,#ff7a18,#ffb347);
  color: #fff;
  box-shadow: 0 0 20px rgba(255,180,80,0.6);
  opacity: 0;
  pointer-events: none;
  transition: opacity .6s ease, transform .2s ease;
}

button.show {
  opacity: 1;
  pointer-events: auto;
}

button:hover { transform: scale(1.05); }
</style>
</head>

<body>
<canvas id="c"></canvas>

<div class="controls">
  <button id="replay">Replay ðŸŽ†</button>
  <button id="sound">Sound ðŸ”Š</button>
</div>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
const replayBtn = document.getElementById("replay");
const soundBtn = document.getElementById("sound");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

/* ========= CONFIG ========= */
const lines = [
  "H A P P Y",
  "B I R T H D A Y !",
  "t o   Y o u"
];

const gravity = 0.06;
let soundOn = true;

/* ========= AUDIO ========= */
const popSound = new Audio(
  "https://orangefreesounds.com/wp-content/uploads/2025/11/Distant-single-firework-blast-sound-effect.mp3"

);

/* ========= ARRAYS ========= */
let letters = [];
let particles = [];
let confetti = [];
let balloons = [];
let startTime = 0;
let fired = false;
let active = false;

/* ========= CONFETTI ========= */
class Confetti {
  constructor() { this.reset(); }
  reset() {
    this.x = Math.random() * canvas.width;
    this.y = Math.random() * canvas.height;
    this.s = Math.random()*2+1;
    this.v = Math.random()*0.4+0.2;
    this.c = `hsla(${Math.random()*360},80%,60%,0.5)`;
  }
  update() {
    this.y += this.v;
    if (this.y > canvas.height) this.reset();
  }
  draw() {
    ctx.fillStyle = this.c;
    ctx.fillRect(this.x,this.y,this.s,this.s);
  }
}
for(let i=0;i<120;i++) confetti.push(new Confetti());

/* ========= BALLOONS ========= */
class Balloon {
  constructor(side) {
    this.side = side;
    this.reset();
  }

  reset() {
    const offset = 160;
    this.x = this.side === "left"
      ? canvas.width / 2 - offset - Math.random()*60
      : canvas.width / 2 + offset + Math.random()*60;

    this.y = canvas.height / 2 + Math.random()*120 - 60;
    this.r = Math.random()*12 + 18;
    this.speed = Math.random()*0.3 + 0.15;
    this.phase = Math.random()*Math.PI*2;
    this.color = `hsl(${Math.random()*360},80%,65%)`;
  }

  update() {
    this.phase += 0.02;
    this.y -= this.speed;
    this.x += Math.sin(this.phase) * 0.4;

    if (this.y < canvas.height/2 - 140) {
      this.y = canvas.height/2 + 140;
    }
  }

  draw() {
    // balloon
    ctx.beginPath();
    ctx.ellipse(this.x, this.y, this.r, this.r*1.2, 0, 0, Math.PI*2);
    ctx.fillStyle = this.color;
    ctx.fill();

    // shine
    ctx.fillStyle = "rgba(255,255,255,0.25)";
    ctx.beginPath();
    ctx.ellipse(this.x - this.r/3, this.y - this.r/3, this.r/4, this.r/3, 0, 0, Math.PI*2);
    ctx.fill();

    // string
    ctx.strokeStyle = "rgba(255,255,255,0.6)";
    ctx.beginPath();
    ctx.moveTo(this.x, this.y + this.r*1.2);
    ctx.lineTo(this.x, this.y + this.r*2.4);
    ctx.stroke();
  }
}

/* ========= PARTICLES ========= */
class Particle {
  constructor(x,y,c) {
    const a = Math.random()*Math.PI*2;
    const s = Math.random()*4+1;
    this.x=x; this.y=y;
    this.vx=Math.cos(a)*s;
    this.vy=Math.sin(a)*s;
    this.l=90;
    this.c=c;
  }
  update() {
    this.vy+=gravity;
    this.x+=this.vx;
    this.y+=this.vy;
    this.l--;
  }
  draw() {
    ctx.fillStyle=this.c;
    ctx.fillRect(this.x,this.y,2,2);
  }
}

/* ========= LETTER ========= */
class Letter {
  constructor(ch,x,y,c,d) {
    this.ch=ch;
    this.x=canvas.width/2;
    this.y=canvas.height+60;
    this.tx=x; this.ty=y;
    this.c=c; this.d=d;
    this.done=false;
  }
  update(t) {
    if(t<this.d) return;
    this.x+=(this.tx-this.x)*0.08;
    this.y+=(this.ty-this.y)*0.08;
    if(Math.abs(this.tx-this.x)<.5 && Math.abs(this.ty-this.y)<.5)
      this.done=true;
  }
  draw() {
    ctx.font="34px Arial";
    ctx.textAlign="center";
    ctx.shadowBlur=18;
    ctx.shadowColor=this.c;
    ctx.fillStyle=this.c;
    ctx.fillText(this.ch,this.x,this.y);
    ctx.shadowBlur=0;
  }
}

/* ========= CREATE ========= */
function create() {
  letters=[]; particles=[];
  fired=false; active=true;
  startTime=performance.now();
  replayBtn.classList.remove("show");
  soundBtn.classList.remove("show");

  balloons = [];
  for(let i=0;i<4;i++) balloons.push(new Balloon("left"));
  for(let i=0;i<4;i++) balloons.push(new Balloon("right"));

  const baseY=canvas.height/2-60;
  lines.forEach((l,r)=>{
    const c=l.split(" ");
    const w=c.length*40;
    const sx=canvas.width/2-w/2;
    c.forEach((ch,i)=>{
      if(!ch) return;
      const h=(i/c.length)*360;
      letters.push(
        new Letter(
          ch,
          sx+i*40,
          baseY+r*50,
          `hsl(${h},80%,60%)`,
          r*400+i*120
        )
      );
    });
  });
}

/* ========= FIRE ========= */
function fire() {
  if(soundOn) popSound.play();
  letters.forEach(l=>{
    for(let i=0;i<45;i++)
      particles.push(new Particle(l.x,l.y,l.c));
  });
  setTimeout(()=>{
    replayBtn.classList.add("show");
    soundBtn.classList.add("show");
  },1200);
}

/* ========= LOOP ========= */
function animate(t) {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  confetti.forEach(c=>{c.update();c.draw();});
  balloons.forEach(b=>{b.update();b.draw();});

  if(active) {
    const e=t-startTime;
    letters.forEach(l=>{l.update(e);l.draw();});
    if(!fired && letters.every(l=>l.done)) {
      fire(); fired=true; active=false;
    }
  }

  for(let i=particles.length-1;i>=0;i--){
    particles[i].update();
    particles[i].draw();
    if(particles[i].l<=0) particles.splice(i,1);
  }

  requestAnimationFrame(animate);
}

/* ========= EVENTS ========= */
replayBtn.onclick=create;
soundBtn.onclick=()=>{
  soundOn=!soundOn;
  soundBtn.textContent=soundOn?"Sound ðŸ”Š":"Sound ðŸ”‡";
};

addEventListener("keydown",e=>{
  if(e.key===" "||e.key==="Enter") create();
});
addEventListener("touchstart",()=> {
  if(!active) create();
});

/* ========= START ========= */
create();
requestAnimationFrame(animate);
</script>
</body>
</html>
